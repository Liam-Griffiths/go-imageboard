{{ define "content" }}
<style>
  @media (max-width: 768px) {
    body {
      font-size: 14px;
      padding: 5px;
    }

    .container {
      max-width: 100%;
      padding: 0;
    }

    .board-title {
      font-size: 20px;
    }

    .board-subtitle {
      font-size: 12px;
    }

    .thread {
      padding: 8px;
      margin-bottom: 15px;
    }

    .post {
      padding: 8px;
      margin-bottom: 8px;
    }

    .post-info {
      font-size: 12px;
      margin-bottom: 8px;
    }

    .post-content {
      font-size: 14px;
      line-height: 1.4;
    }

    /* Improve touch targets */
    .board-nav a, .post-info a {
      padding: 5px;
      display: inline-block;
    }
  }
</style>
<div>
    <div class="board-header">
        <h1 class="board-title">/{{ .Board.Slug }}/ - {{ .Board.Name }}</h1>
        <div class="board-subtitle">{{ .Board.Description }}</div>
    </div>

    <div class="board-nav">
        [<a href="/">Home</a>]
        [<a href="/{{ .Board.Slug }}/catalog">Catalog</a>]
    </div>

    <hr class="hr">

    <!-- New Thread Form -->
    <div class="form-box">
        <form action="/new-thread" method="post" enctype="multipart/form-data" style="display: flex; flex-direction: column;">
            <input type="hidden" name="board_id" value="{{ .Board.ID }}">

            <div style="margin-bottom: 10px;">
                <label class="form-label" style="display: block; margin-bottom: 5px;">Name</label>
                <input type="text" name="name" value="Anonymous" disabled style="width: 100%; box-sizing: border-box;">
            </div>

            <div style="margin-bottom: 10px;">
                <label class="form-label" style="display: block; margin-bottom: 5px;">Subject</label>
                <input type="text" id="title" name="title" required style="width: 100%; box-sizing: border-box;">
            </div>

            <div style="margin-bottom: 10px;">
                <label class="form-label" style="display: block; margin-bottom: 5px;">Comment</label>
                <textarea id="content" name="content" rows="4" required style="width: 100%; box-sizing: border-box;"></textarea>
            </div>

            <div style="margin-bottom: 10px;">
                <label class="form-label" style="display: block; margin-bottom: 5px;">File</label>
                <input type="file" id="image" name="image" accept="image/*" style="width: 100%;">
            </div>

            <div style="margin-bottom: 10px;">
                <label class="form-label" style="display: block; margin-bottom: 5px;">Verification</label>
                <div class="g-recaptcha" data-sitekey="6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI"></div>
            </div>

            <div style="margin-top: 10px;">
                <input type="submit" value="New Thread" class="submit-btn" style="padding: 8px 12px;">
            </div>
        </form>
    </div>

    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <hr class="hr">

    <!-- Thread Listing -->
    {{ if .ThreadsWithPosts }}
    {{ range .ThreadsWithPosts }}
    <div class="thread">
        <div class="post">
            <div class="post-info">
                Anonymous 
                {{ if .FirstPost.UserID }}
                <span class="user-id" style="color: #117743; font-weight: bold;">(ID: {{ .FirstPost.UserID }})</span>
                {{ end }}
                {{ if .FirstPost.CountryCode }}
                <span class="country-code">({{ .FirstPost.CountryCode }})</span>
                {{ end }}
                <span class="post-date">{{ formatTime .Thread.CreatedAt }}</span>
                <span class="post-num">No.{{ .Thread.ID }}</span>
                [<a href="/{{ $.Board.Slug }}/thread/{{ .Thread.ID }}/">Reply</a>]
            </div>

            <div class="post-content">
                {{ if .FirstPost.ImagePath }}
                <div class="file-info">
                    <b>File:</b> {{ .FirstPost.ImagePath }}
                </div>
                <div>
                    <a href="/images/{{ .FirstPost.ImagePath }}/" target="_blank">
                        <img src="/images/{{ .FirstPost.ImagePath }}/" alt="Posted image" class="post-image">
                    </a>
                </div>
                {{ end }}
                <div>
                    <a href="/{{ $.Board.Slug }}/thread/{{ .Thread.ID }}/"><b>{{ .Thread.Title }}</b></a>
                    <div>
                        <span>{{ .FirstPost.Content }}</span>
                    </div>
                </div>
                <div class="clear"></div>
            </div>

            <!-- Latest Posts -->
            {{ if .LatestPosts }}
            <div style="margin-top: 10px; border-top: 1px dashed #D9BFB7; padding-top: 5px;">
                <div style="font-size: 9pt; color: #800000; margin-bottom: 5px;">Latest replies:</div>
                {{ range .LatestPosts }}
                <div class="post" style="background-color: #F0E0D6; margin-bottom: 5px; padding: 5px; border: 1px solid #D9BFB7;">
                    <div class="post-info" style="font-size: 9pt;">
                        Anonymous 
                        {{ if .UserID }}
                        <span class="user-id" style="color: #117743; font-weight: bold;">(ID: {{ .UserID }})</span>
                        {{ end }}
                        {{ if .CountryCode }}
                        <span class="country-code">({{ .CountryCode }})</span>
                        {{ end }}
                        <span class="post-date">{{ formatTime .CreatedAt }}</span>
                        <span class="post-num">No.{{ .ID }}</span>
                    </div>
                    {{ if .ImagePath }}
                    <div>
                        <a href="/images/{{ .ImagePath }}" target="_blank">
                            <img src="/images/{{ .ImagePath }}" alt="Posted image" style="max-width: 75px; max-height: 75px; margin-right: 5px; float: left;">
                        </a>
                    </div>
                    {{ end }}
                    <div class="post-content" style="font-size: 9pt;">
                        {{ truncate .Content 100 }}
                    </div>
                    <div class="clear"></div>
                </div>
                {{ end }}
                <div style="text-align: right; margin-top: 5px;">
                    <a href="/{{ $.Board.Slug }}/thread/{{ .Thread.ID }}" style="font-size: 9pt; color: #800000;">View all {{ .Thread.PostCount }} replies &raquo;</a>
                </div>
            </div>
            {{ end }}

            <div style="margin-top: 5px;">
                <span style="color: #666;">{{ .Thread.PostCount }} posts</span> |
                <span style="color: #666;">Last update: {{ formatTime .Thread.UpdatedAt }}</span>
                {{ if $.IsAdmin }}
                <form action="/admin/delete-thread" method="post" style="display: inline; margin-left: 10px;" onsubmit="return confirm('Are you sure you want to delete this thread?');">
                  <input type="hidden" name="thread_id" value="{{ .Thread.ID }}">
                  <button type="submit" class="delete-btn" style="color: red; background: none; border: none; cursor: pointer; font-size: 12px;">Delete Thread</button>
                </form>
                {{ end }}
            </div>
        </div>
    </div>
    {{ end }}
    {{ else }}
    <div class="thread">
        <div class="post-content" style="text-align: center; padding: 20px;">
            <span style="color: #666;">No threads yet. Be the first to create one!</span>
        </div>
    </div>
    {{ end }}

    <hr class="hr">

    <div class="board-nav">
        [<a href="/">Home</a>]
        [<a href="/{{ .Board.Slug }}/catalog">Catalog</a>]
    </div>
</div>
{{ end }}
